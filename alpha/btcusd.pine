//@version=5
strategy("CRO/USD MA 25 & MA 99 Strategy", overlay=true)

// Inputs for Moving Averages
ma25Length = input.int(25, title="MA 25 Length", minval=1)
ma99Length = input.int(99, title="MA 99 Length", minval=1)
maSource = input.source(close, title="MA Source")

// Calculate Moving Averages
ma25 = ta.sma(maSource, ma25Length)
ma99 = ta.sma(maSource, ma99Length)

// Plot the Moving Averages
plot(ma25, color=color.blue, title="MA 25", linewidth=2)
plot(ma99, color=color.orange, title="MA 99", linewidth=2)

// Conditions for Trading
maFilter = ma25 > ma99 // Only trade if MA25 > MA99

// Check for green candles (close > open) and completely above MA25
greenCandle1 = close[1] > open[1] and close[1] > ma25[1] and open[1] > ma25[1]
greenCandle2 = close > open and close > ma25 and open > ma25

// Check for red candles (sell condition) and completely below MA25
redCandle1 = close[1] < open[1] and close[1] < ma25[1] and open[1] < ma25[1]
redCandle2 = close < open and close < ma25 and open < ma25

// Updated Buy and Sell Signals
buySignal = greenCandle1 and greenCandle2 and maFilter and strategy.position_size == 0
sellSignal = redCandle1 and redCandle2 and strategy.position_size != 0

// Execute Trades
if (buySignal)
    strategy.entry("Buy", strategy.long, qty=100 / close) // Buy â‚¬100 worth of CRO/USD

if (sellSignal)
    strategy.close("Buy") // Close the long position

// Optional Visual Aids: Plot Buy/Sell Signals
plotshape(series=buySignal, title="Buy Signal", location=location.belowbar, 
          color=color.green, style=shape.labelup, text="BUY")
plotshape(series=sellSignal, title="Sell Signal", location=location.abovebar, 
          color=color.red, style=shape.labeldown, text="SELL")